var adlinkCommonMethod=function(){var b,c,f=["test.point-ad-game.com","www.ad.phalanx.co.jp"],g=".ac.jp .co.jp .go.jp .or.jp .ad.jp .ne.jp .gr.jp .ed.jp .lg.jp".split(" ");return{setConfig:function(){-1!=f.indexOf(location.hostname)?(b=!0,c="click.ad.phalanx.co.jp/"):(b=!1,c="click.ad-link.jp/");return!0},getCvCookieName:function(b,d){return"adlink_od_"+b+"["+d+"]"},getLpKeyName:function(){return"_adk"},getLpValLength:function(){return 60},getOrderSpanKeyName:function(){return"_adk"},getOrderedCookieVal:function(){return"complete"},
getOrderedCookieExdays:function(){return.007},getOrderedCookieDeleteVal:function(){return"deleted"},getTrackUrlDomain:function(){return c},getTrackImgPath:function(){return"order.php/"},getTrackScriptPath:function(){return"track/tag/sorder/"},getTrackScriptCallbackName:function(){return"adlinkOrderResultMethod.getResult"},getRevisitNgFlag:function(){return"0"},log:function(e,d,c,a){a=void 0===a?"":a;if("debug"!=e||1==b){var k="[Ad-Link]["+e+"]";k=0!=d?k+"["+d+"] "+c:k+" "+c;switch(e){case "debug":console.debug(k);
""!=a&&console.debug(a);break;case "info":console.info(k);""!=a&&console.info(a);break;case "log":console.log(k);""!=a&&console.log(a);break;case "warn":console.warn(k);""!=a&&console.warn(a);break;case "error":console.error(k),""!=a&&console.error(a)}}return!0},setCookie:function(b,d,c,a){d=this.getExpires_(d);d=""==d?b+"="+escape(c)+"; path=/":b+"="+escape(c)+"; expires="+d+"; path=/";return this.setDomainCookie_(b,d,c,a)},deleteCookie:function(b,c,f){var a=this.getExpires_(-1);a=b+"="+adlinkCommonMethod.getOrderedCookieDeleteVal()+
"; expires="+a+"; path=/";return this.setDomainCookie_(b,a,c,f)},setDomainCookie_:function(b,c,f,a){for(var d="",e,h=0,m=location.hostname.split("."),l=m.length;0<l;l--)if(h++,e=c,d="."+m[l-1]+d,1!=h)if(-1!=g.indexOf(d))this.log("debug",a,"cookie set: domain that can not be set. cookie name => "+b+" domain => "+d);else{e=e+"; domain="+d;document.cookie=e;if(this.getCookie(b,a)==f)return this.log("debug",a,"cookie set: cookie that attempted to set succeeded. value => "+e),!0;this.log("debug",a,"cookie set: cookie that attempted to set failed. value => "+
e)}return!1},getExpires_:function(b){"number"==typeof b&&(b=String(b));if("-1"==b){var c=new Date;c.setTime(0);return c.toUTCString()}if("0"==b)return"";c=new Date;c.setTime(c.getTime()+864E5*b);return c.toUTCString()},getCookie:function(b,c){var d=document.cookie,a=d.indexOf(b+"=");if(-1==a)return this.log("debug",c,"cookie get: cookie does not exist. name => "+b),"";var e=a+b.length+1,f=d.indexOf(";",e);-1==f&&(f=d.length);cookieVal=d.substring(e,f);cookieVal=unescape(cookieVal);this.log("debug",
c,"cookie get: cookie exist. name => "+b+" value => "+cookieVal+" target => "+a);return cookieVal}}}(),adlinkClickMethod=function(){var b,c,f,g,e;return{setInitialize:function(){c=b=0;f="";g=0;e=""},getPid:function(){return b},getLpParam:function(){var c=window.location.search.split("?");if(1<c.length){c=c[1].split("&");for(var f=0;f<c.length;f++){var a=c[f].split("=");if(a[0]==adlinkCommonMethod.getLpKeyName()&&0<a[1].length)return this.setData_(a[1])}}adlinkCommonMethod.log("info",b,"click: no parameters.");
return!1},setData_:function(d){d=d.replace(/\s+/g,"");if(d.length>adlinkCommonMethod.getLpValLength())throw"click: length of parameter value is long. val => "+d;d=d.split("_");b=d[0];c=d[1];f=d[2];g=d[3];this.validateParameters_();e=adlinkCommonMethod.getCvCookieName(b,c);return this.validateOrdered_()},validateOrdered_:function(){return adlinkCommonMethod.getCookie(e,b)==adlinkCommonMethod.getOrderedCookieVal()?(adlinkCommonMethod.log("info",b,"click: already ordered promotion."),!1):!0},validateParameters_:function(){if("undefined"===
typeof b||!b.match(/^[0-9]{10}$/))throw"click: parameter of pid is error. pid => "+b;"undefined"!==typeof c&&c.match(/^[0-9]{1,3}$/)||(adlinkCommonMethod.log("warn",b,"click: parameter of plid is error. val of plid changed to 0. plid => "+c),c=0);if("undefined"===typeof f||!f.match(/^[0-9a-zA-Z]{40}$/))throw"click: parameter of cookie_rand is error. cookie_rand => "+f;"undefined"!==typeof g&&g.match(/^[0-9]{1,3}$/)||(adlinkCommonMethod.log("warn",b,"click: parameter of ex_days is error. val of ex_days changed to 0. ex_days => "+
g),g=0);return!0},setLpCookie:function(){if(0==location.hostname.split(".").length)throw"click: target domain not found. domain => "+location.hostname+".";if(!1===adlinkCommonMethod.setCookie(e,g,f,b))throw"click: failed to set cookie of click.";return!0}}}();
function clickAdlink(){try{adlinkCommonMethod.setConfig();adlinkClickMethod.setInitialize();if(!1===adlinkClickMethod.getLpParam())return!1;adlinkCommonMethod.log("info",adlinkClickMethod.getPid(),"click: succeeded to set parameter.");adlinkClickMethod.setLpCookie();adlinkCommonMethod.log("info",adlinkClickMethod.getPid(),"click: succeeded to set cookie of click.");return!0}catch(b){return adlinkCommonMethod.log("error",adlinkClickMethod.getPid(),b),!1}}clickAdlink();
var adlinkOrderMethod=function(){var b,c,f,g,e,d,h;return{setInitialize:function(){c=b=0;f="";g=0;d=e="";h=!1},getPid:function(){return b},getOrderParam:function(a){adlinkCommonMethod.log("info",b,"pid:"+a.pid+"/plid:"+a.plid+"/xid:"+a.xid+"/price:"+a.price+"/img:"+a.img+"/limit:"+a.limit);"undefined"!=typeof a.pid&&(b=a.pid);"undefined"!=typeof a.plid&&(c=a.plid);"undefined"!=typeof a.xid&&(f=a.xid);"undefined"!=typeof a.price&&(g=a.price);this.setParamOption_(a);adlinkCommonMethod.log("debug",b,
"order: parameters => ",a);this.validateOrderParameters_();e=this.getCvCookie_();return this.validateCookieRand_()},setParamOption_:function(a){h=!1;if("undefined"===typeof a.img||!1===a.img)return!0;if(!0!==a.img)return adlinkCommonMethod.log("warn",b,"order: option parameter: parameter of img is error. img => "+a.img),!0;if(!0===a.img){if("undefined"===typeof a.limit)return adlinkCommonMethod.log("warn",b,"order: option parameter: parameter of limit is not exists."),!0;var c=this.changeVariableType_(a.limit);
if(!c.match(/^[0-9]+$/))return adlinkCommonMethod.log("warn",b,"order: option parameter: parameter of limit is error. limit => "+a.limit),!0;if(c>Math.floor((new Date).getTime()/1E3))return h=!0}},validateOrderParameters_:function(){b=this.changeVariableType_(b);c=this.changeVariableType_(c);f=this.changeVariableType_(f);g=this.formatPriceByFloor_(g);if(!b.match(/^[0-9]{10}$/))throw"order: parameter of pid is error. pid => "+b;0==c||c.match(/^[0-9]{1,3}$/)||(adlinkCommonMethod.log("warn",b,"order: parameter of plid is error. val of plid changed 0. plid => "+
c),c=0);if(!f)throw"order: parameter of order_number is error. order_number => "+f;if(!g.match(/^[0-9]{1,7}$/))throw"order: parameter of price is error. price => "+g;return!0},validateCookieRand_:function(){if(e==adlinkCommonMethod.getOrderedCookieVal())return adlinkCommonMethod.log("info",b,"order: already ordered promotion."),!1;if(!1===h&&""==e)return adlinkCommonMethod.log("info",b,"order: cookie of click does not exist."),!1;if(""!=e&&!e.match(/^[0-9a-zA-Z]{40}$/))throw"order: parameter of cookie_rand is error. cookie_rand  => "+
e;return!0},formatPriceByFloor_:function(a){"string"==typeof a&&(a=a.replace(/\s+/g,""),a=Number(a));"number"==typeof a&&(a=Math.floor(a),a=String(a));adlinkCommonMethod.log("debug",b,"order: result of variable after truncated: val => "+a+" type => "+typeof a);return a},changeVariableType_:function(a){"string"==typeof a&&(a=a.replace(/\s+/g,""));"number"==typeof a&&(a=String(a));adlinkCommonMethod.log("debug",b,"order: result of variable after change type: val => "+a+" type => "+typeof a);return a},
getCvCookie_:function(){if(0>=document.cookie.length)return"";d=adlinkCommonMethod.getCvCookieName(b,c);e=adlinkCommonMethod.getCookie(d,b);""!=e&&adlinkCommonMethod.log("info",b,"order: succeeded to get cookie of click.");return e},execConversion:function(){if(!0===h&&""==e){var a=this.createImgCvTag_();1==a&&adlinkCommonMethod.log("info",b,"order: succeeded to create conversion tag of img.");return a}a=this.asyncHttpRequest_();1==a&&adlinkCommonMethod.log("info",b,"order: succeeded to create conversion tag of javascript.");
return a},createImgCvTag_:function(){var a=b+"/a?plan="+c+"&xid="+f+"&amount="+g,d=adlinkCommonMethod.getTrackUrlDomain(),e=adlinkCommonMethod.getTrackImgPath();a="//"+d+e+a;d=document.createElement("img");d.setAttribute("src",a);d.setAttribute("width","0");d.setAttribute("height","0");d.setAttribute("border","0");adlinkCommonMethod.log("debug",b,"order: conversion tag of img => "+a);e=document.getElementById(adlinkCommonMethod.getOrderSpanKeyName());if(null==e)return adlinkCommonMethod.log("warn",
b,"order: conversion tag of img: not exists span tag of adlink into html."),document.write('<img src = "'+a+'" width = "0" height = "0" border = "0" >'),!0;if(null==e.appendChild(d))throw"order: failed to create conversion tag of img.";return!0},asyncHttpRequest_:function(){var a="?callback="+adlinkCommonMethod.getTrackScriptCallbackName(),d="&pid="+b+"&plan="+c+"&xid="+f+"&amount="+g+"&cookie_rand="+e,h=adlinkCommonMethod.getTrackUrlDomain(),n=adlinkCommonMethod.getTrackScriptPath();a="//"+h+n+a+
d;d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",a);adlinkCommonMethod.log("debug",b,"order: conversion tag of javascript => "+a);h=document.getElementById(adlinkCommonMethod.getOrderSpanKeyName());if(null==h)return adlinkCommonMethod.log("warn",b,"order: convesion tag of javascript: not exists span tag of adlink into html."),document.write('<script type="text/javascript" src="'+a+'">\x3c/script>'),!0;if(null==h.appendChild(d))throw"order: failed to create conversion tag of javascript.";
return!0}}}();
function orderAdlink(b){try{adlinkCommonMethod.setConfig();adlinkOrderMethod.setInitialize();var c=adlinkOrderMethod.getOrderParam(b);if(!1===c)return!1;adlinkCommonMethod.log("info",adlinkOrderMethod.getPid(),"order: succeeded to set parameter.");c=adlinkOrderMethod.execConversion();if(!1===c)return adlinkCommonMethod.log("info",adlinkOrderMethod.getPid(),"order: failed to order."),!1;adlinkCommonMethod.log("info",adlinkOrderMethod.getPid(),"order: succeeded to order.");return!0}catch(f){return adlinkCommonMethod.log("error",adlinkOrderMethod.getPid(),
f),!1}}
var adlinkOrderResultMethod=function(){return{getResult:function(b){try{adlinkCommonMethod.setConfig();var c=0,f=0,g=0;b.pid&&(c=b.pid);b.plid&&(f=b.plid);b.cookie_rand&&(g=b.cookie_rand);adlinkCommonMethod.log("debug",c,"order: result data of javascript tag => ",b);if("undefined"===typeof b.result)throw"order: return value of javascript tag does not exist.";if(!c.match(/^[0-9]{10}$/))throw"order: result data: parameter of pid is error. pid => "+c;0==f||f.match(/^[0-9]{1,3}$/)||(adlinkCommonMethod.log("warn",c,
"order: result data: parameter of plid is error. val of plid changed 0. plid => "+f),f=0);if(""!=g&&!g.match(/^[0-9a-zA-Z]{40}$/))throw"order: result data: parameter of cookie_rand is error. cookie_rand  => "+g;if(0==b.result){adlinkCommonMethod.log("info",c,"order: return value of javascript tag: no order.");cvCookieName_=adlinkCommonMethod.getCvCookieName(c,f);var e=adlinkCommonMethod.deleteCookie(cvCookieName_,g,c);!1===e?adlinkCommonMethod.log("warn",c,"order: failed to delete cookie of click."):
adlinkCommonMethod.log("info",c,"order: succeeded to delete cookie of click.");return!0}adlinkCommonMethod.log("info",c,"order: return value of javascript tag: ordered.");if("undefined"!==typeof b.revisit&&b.revisit===adlinkCommonMethod.getRevisitNgFlag())return cvCookieName_=adlinkCommonMethod.getCvCookieName(c,f),e=adlinkCommonMethod.setCookie(cvCookieName_,adlinkCommonMethod.getOrderedCookieExdays(),adlinkCommonMethod.getOrderedCookieVal(),c),!1===e?adlinkCommonMethod.log("warn",c,"order: failed to rewrite cookie of click."):
adlinkCommonMethod.log("info",c,"order: succeeded to rewrite cookie of click."),!0}catch(d){return adlinkCommonMethod.log("error",c,d),!1}}}}();
